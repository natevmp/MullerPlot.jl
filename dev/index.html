<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MullerPlot.jl Documentation · MullerPlot.jl Documentation</title><meta name="title" content="MullerPlot.jl Documentation · MullerPlot.jl Documentation"/><meta property="og:title" content="MullerPlot.jl Documentation · MullerPlot.jl Documentation"/><meta property="twitter:title" content="MullerPlot.jl Documentation · MullerPlot.jl Documentation"/><meta name="description" content="Documentation for MullerPlot.jl Documentation."/><meta property="og:description" content="Documentation for MullerPlot.jl Documentation."/><meta property="twitter:description" content="Documentation for MullerPlot.jl Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MullerPlot.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>MullerPlot.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Example-usage"><span>Example usage</span></a></li><li><a class="tocitem" href="#Module-Index"><span>Module Index</span></a></li><li><a class="tocitem" href="#Detailed-API"><span>Detailed API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>MullerPlot.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MullerPlot.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/natevmp/MullerPlot.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/natevmp/MullerPlot.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MullerPlot.jl-Documentation"><a class="docs-heading-anchor" href="#MullerPlot.jl-Documentation">MullerPlot.jl Documentation</a><a id="MullerPlot.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#MullerPlot.jl-Documentation" title="Permalink"></a></h1><h2 id="Example-usage"><a class="docs-heading-anchor" href="#Example-usage">Example usage</a><a id="Example-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Example-usage" title="Permalink"></a></h2><p>First we load population size and parental relationship data.</p><pre><code class="language-julia hljs">using CSV, DataFrames

n_t_vid = CSV.File(&quot;data/dataMullerplot_sizes.csv&quot;, header=false) |&gt; Tables.matrix
parentVid_vid = CSV.File(&quot;data/dataMullerplot_parentLineage.csv&quot;, header=false) |&gt; Tables.matrix |&gt; vec
tBirth_vid = CSV.File(&quot;data/dataMullerplot_arrivalTimes.csv&quot;, header=false) |&gt; Tables.matrix |&gt; vec</code></pre><p>To use the package functionality, the input data has several requirements. <code>n_t_vid</code> must be a matrix of clone sizes, where the first dimension is indexed by the time points at which the sizes are measured, and the second by the different clones. Each clone in the system is designated an integer id that coincides with its index in any array indexing over the different clones:</p><table><tr><th style="text-align: left"><code>n_t_vid</code></th><th style="text-align: center">clone 1</th><th style="text-align: center">clone 2</th><th style="text-align: center">clone 3</th><th style="text-align: center">...</th></tr><tr><td style="text-align: left"><span>$t_1$</span></td><td style="text-align: center"><span>$n_1(t_1)$</span></td><td style="text-align: center"><span>$n_2(t_1)$</span></td><td style="text-align: center"><span>$n_3(t_1)$</span></td><td style="text-align: center">...</td></tr><tr><td style="text-align: left"><span>$t_2$</span></td><td style="text-align: center"><span>$n_1(t_2)$</span></td><td style="text-align: center"><span>$n_2(t_2)$</span></td><td style="text-align: center"><span>$n_3(t_2)$</span></td><td style="text-align: center">...</td></tr><tr><td style="text-align: left"><span>$t_3$</span></td><td style="text-align: center"><span>$n_1(t_3)$</span></td><td style="text-align: center"><span>$n_2(t_3)$</span></td><td style="text-align: center"><span>$n_3(t_3)$</span></td><td style="text-align: center">...</td></tr><tr><td style="text-align: left">...</td><td style="text-align: center">...</td><td style="text-align: center">...</td><td style="text-align: center">...</td><td style="text-align: center">...</td></tr></table><p>Clone sizes <span>$n_i(t)$</span> should be specified as a fraction of the total population size and exclude any subclones, so that <span>$\forall j : \sum_i n_i(t_j) = 1$</span>. </p><p><code>parentVid_vid</code> is a vector indexed by the different clone id&#39;s, containing the id (/index) of the clone&#39;s direct parent.  For example, <code>parentVid_vid[5]</code> returns the id/index of the parent of the clone at index 5. All clones that do not have direct parent in the system, or who&#39;s direct parent is the wild type, should be given the parent with id 0.</p><p>Next we create bounds for plotting each clone.</p><pre><code class="language-julia hljs">using MullerPlot

xL_t_vid, xU_t_vid = mullerBounds(n_t_vid, parentVid_vid)</code></pre><p>The method <code>mullerBounds(...)</code> returns two matrices containing the coordinates of respectively the upper and lower bounds of each clone (newly arising population) in the population. The first dimension of these  matrices indexes the measurement times (typically the x-axis of a Muller plot), and the second the different clones. For example <code>xL_t_vid[:,5]</code> is a vector containing the size-axis coordinate (usually the y-axis) of the lower bound of the 5th clone at all timepoints, and <code>xL_t_vid[5,:]</code> is a vector containing the size-axis coordinates of all clones at the 5th timepoint.</p><p>It is also possible to select only a subset of clones for the plot, using a boolean vector as third argument. For example, if we wish to only show clones that consist of at least 1% of the population at the final measurement time:</p><pre><code class="language-julia hljs">visible_vid = n_t_vid[end,:] .&gt; 0.01
xL_t_vid, xU_t_vid = MullerPlot.mullerBounds(n_t_vid, parentVid_vid, visible_vid)</code></pre><p>Now we use the <code>Makie.jl</code> package to construct the plot.</p><pre><code class="language-julia hljs">_t = range(0,100,length=size(n_t_vid,1)) # set equidistant measurement times

using CairoMakie

fig = Figure(size=(800,600), fontsize=25)
Axis(
    fig[1,1],
    backgroundcolor=:grey75,
    xgridvisible=false,
    ygridvisible=false,
    yticksvisible=false,
    yticklabelsvisible=false,
    xticks=[0,25,50,75,100],
    xlabel=&quot;time&quot;,
)
for i in 2:size(xL_t_vid,2) # the first index is the wild type
    band!(
        _t, xL_t_vid[:,i], xU_t_vid[:,i],
    )
    scatter!(
        tBirth_vid[visible_vid][i],
        xU_t_vid[Int(round(tBirth_vid[visible_vid][i]))+1, i],
        markersize=15,
        marker=:star4,
    )
    println(tBirth_vid[i])
end
ylims!(0,1)
xlims!(0,100)
display(fig)</code></pre><h2 id="Module-Index"><a class="docs-heading-anchor" href="#Module-Index">Module Index</a><a id="Module-Index-1"></a><a class="docs-heading-anchor-permalink" href="#Module-Index" title="Permalink"></a></h2><ul><li><a href="#MullerPlot.buildFamilyArray-Tuple{Vector{T} where T&lt;:Integer}"><code>MullerPlot.buildFamilyArray</code></a></li><li><a href="#MullerPlot.getLowerCoordinateFromParent-NTuple{5, Any}"><code>MullerPlot.getLowerCoordinateFromParent</code></a></li><li><a href="#MullerPlot.mullerBounds-Tuple{AbstractMatrix{T} where T&lt;:Real, Array{Vector{V}, 1} where V&lt;:Integer}"><code>MullerPlot.mullerBounds</code></a></li><li><a href="#MullerPlot.sizeVariantRec-Tuple{Integer, AbstractVector{&lt;:Float64}, AbstractArray{&lt;:AbstractArray{&lt;:Integer}}}"><code>MullerPlot.sizeVariantRec</code></a></li><li><a href="#MullerPlot.variantBirthTimes-Tuple{AbstractMatrix{&lt;:Real}}"><code>MullerPlot.variantBirthTimes</code></a></li></ul><h2 id="Detailed-API"><a class="docs-heading-anchor" href="#Detailed-API">Detailed API</a><a id="Detailed-API-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MullerPlot.buildFamilyArray-Tuple{Vector{T} where T&lt;:Integer}" href="#MullerPlot.buildFamilyArray-Tuple{Vector{T} where T&lt;:Integer}"><code>MullerPlot.buildFamilyArray</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">buildFamilyArray(parentVid_vid)</code></pre><p>Create a vector <code>vid_child_Vid</code>, indexed by the variant id&#39;s <code>vid</code>, that has as elements the children of each variant stored as a vector of id&#39;s. For example, <code>vid_child_Vid[5]</code> is a vector <code>vid_child</code> whose elements are the <code>vid</code>&#39;s of the children of the variant with <code>vid=5</code>.</p><p><code>parentVid_vid</code>:    Vector indexed by the variant id&#39;s <code>vid</code>, where each element refers to that variant&#39;s parent <code>vid</code>. For example <code>parentVid_vid[5]</code> is the <code>vid</code> of the parent of the variant with <code>vid=5</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/natevmp/MullerPlot.jl/blob/d7ff69d3024c1cee21de9e279449b71a9127336e/src/MullerPlot.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MullerPlot.getLowerCoordinateFromParent-NTuple{5, Any}" href="#MullerPlot.getLowerCoordinateFromParent-NTuple{5, Any}"><code>MullerPlot.getLowerCoordinateFromParent</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">getLowerCoordinateFromParent(parent, xL_vid, xU_vid, n_vid, vid_child_Vid)</code></pre><p>Get y-axis coordinate for the lower bound of all child clones of a parent clone.</p><p><code>parent</code>:   variant id (<code>vid</code>) of parent clone <br/><code>xL_vid</code>:   vector of lower bounds in draw space indexed by variant id&#39;s (<code>vid</code>) <br/><code>xU_vid</code>:   vector of upper bounds in draw space indexed by variant id&#39;s (<code>vid</code>) <br/><code>n_vid</code>:    vector of clone sizes indexed by variant id <br/><code>vid_child_Vid</code>: vector (indexed by variant id) where each element is a vector of that variant&#39;s children (given as their variant id&#39;s)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/natevmp/MullerPlot.jl/blob/d7ff69d3024c1cee21de9e279449b71a9127336e/src/MullerPlot.jl#L38-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MullerPlot.mullerBounds-Tuple{AbstractMatrix{T} where T&lt;:Real, Array{Vector{V}, 1} where V&lt;:Integer}" href="#MullerPlot.mullerBounds-Tuple{AbstractMatrix{T} where T&lt;:Real, Array{Vector{V}, 1} where V&lt;:Integer}"><code>MullerPlot.mullerBounds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mullerBounds(n_t_vid, vid_child_Vid)</code></pre><p>Return lower and upper bounds <code>xL_t_vid</code> and <code>xU_t_vid</code> of variant bands for creating a Muller plot.</p><p><code>n_t_vid</code>: two dimensional Array whose elements are variant clone sizes. The first dimension <code>_t</code> is the timepoints at which the measurements occured; the second dimension <code>_vid</code> identifies the variant (i.e. the variant id). The first index refers to the wild type. <br/><code>vid_child_Vid</code>: A nested array indexed by the variant id&#39;s. Its elements are 1D Vectors which contain the variant id&#39;s of each variant&#39;s children.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/natevmp/MullerPlot.jl/blob/d7ff69d3024c1cee21de9e279449b71a9127336e/src/MullerPlot.jl#L67-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MullerPlot.sizeVariantRec-Tuple{Integer, AbstractVector{&lt;:Float64}, AbstractArray{&lt;:AbstractArray{&lt;:Integer}}}" href="#MullerPlot.sizeVariantRec-Tuple{Integer, AbstractVector{&lt;:Float64}, AbstractArray{&lt;:AbstractArray{&lt;:Integer}}}"><code>MullerPlot.sizeVariantRec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sizeVariantRec(vid, n_vid, vid_child_Vid)</code></pre><p>Get combined size of all child clones of a variant.</p><p><code>vid</code>:            variant id of parent <br/><code>n_vid</code>:          vector of clone sizes indexed by variant id <br/><code>vid_child_Vid</code>:  vector (indexed by variant id) where each element is a vector of that variant&#39;s children (given as their variant id&#39;s)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/natevmp/MullerPlot.jl/blob/d7ff69d3024c1cee21de9e279449b71a9127336e/src/MullerPlot.jl#L21-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MullerPlot.variantBirthTimes-Tuple{AbstractMatrix{&lt;:Real}}" href="#MullerPlot.variantBirthTimes-Tuple{AbstractMatrix{&lt;:Real}}"><code>MullerPlot.variantBirthTimes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">variantBirthTimes(n_t_vid)</code></pre><p>Get the arrival (birth) times of each clone in the system</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/natevmp/MullerPlot.jl/blob/d7ff69d3024c1cee21de9e279449b71a9127336e/src/MullerPlot.jl#L103-L107">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 23 July 2024 12:41">Tuesday 23 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
